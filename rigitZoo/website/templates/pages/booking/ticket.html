{% extends 'pages/base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card bg-dark text-white shadow-lg mb-5">
                <div class="card-body p-4 text-center">
                    {% if error %}
                        <p class="text-danger">{{ error }}</p>
                    {% else %}
                        {% if qr_data %}
                            <img src="data:image/png;base64,{{ qr_data }}" class="img-fluid rounded mb-3" style="max-height: 300px; object-fit: contain;" alt="Ticket QR">
                            {% if ticket_info %}
                                <div class="text-start mb-3">
                                    <h5 class="text-white">Booking summary</h5>
                                    {% if ticket_info.type == 'hotel' %}
                                        <p class="mb-1"><strong>Type:</strong> Hotel stay</p>
                                        <p class="mb-1"><strong>Arrive:</strong> {{ ticket_info.arrive }}</p>
                                        <p class="mb-1"><strong>Leave:</strong> {{ ticket_info.leave }}</p>
                                        <p class="mb-1"><strong>Nights:</strong> {{ ticket_info.nights }}</p>
                                        <p class="mb-1"><strong>Adults:</strong> {{ ticket_info.adults }}</p>
                                        <p class="mb-1"><strong>Children:</strong> {{ ticket_info.children }}</p>
                                        <p class="mb-1"><strong>Seniors:</strong> {{ ticket_info.seniors }}</p>
                                        <p class="mb-1"><strong>Total:</strong> £{{ ticket_info.total_cost }}</p>
                                    {% elif ticket_info.type == 'day' %}
                                        <p class="mb-1"><strong>Type:</strong> Day pass</p>
                                        <p class="mb-1"><strong>Date:</strong> {{ ticket_info.date }}</p>
                                        <p class="mb-1"><strong>Adults:</strong> {{ ticket_info.adults }}</p>
                                        <p class="mb-1"><strong>Children:</strong> {{ ticket_info.children }}</p>
                                        <p class="mb-1"><strong>Seniors:</strong> {{ ticket_info.seniors }}</p>
                                        <p class="mb-1"><strong>Total:</strong> £{{ ticket_info.total_cost }}</p>
                                    {% endif %}
                                </div>
                            {% endif %}
                            <p class="mb-0">Ticket Code:</p>
                            <p class="fw-bold fs-5">{{ ticket_code }}</p>
                        {% else %}
                            <img src="{% static 'images/qr_placeholder.png' %}" class="img-fluid rounded mb-3" style="max-height: 200px; object-fit: cover;" alt="QR Placeholder">
                        {% endif %}
                    {% endif %}
                    <div class="mt-3">
                        <a href="{% url 'booking' %}" class="btn btn-outline-light">
                            <i class="fas fa-arrow-left me-2"></i>Other booking options
                        </a>
                        {% if ticket_code %}
                            <a href="{% url 'ticket' ticket_code %}" class="btn btn-success ms-2">View / Share Link</a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
